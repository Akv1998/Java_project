properties([
    parameters([
        string(defaultValue: 'dev-uat', name: 'BRANCH'),
        string(defaultValue: 'master', name: 'comp'),
        string(defaultValue: 'master', name: 'mvn'),
        string(defaultValue: 'service', name: 'action')
    ])
])

node {
    cleanWs()

    stage('Git Checkout') {
        git branch: "${params.BRANCH}", credentialsId: 'myjenkins', url: 'git@github.com:pjitss/docker-Java-kubernetes-project.git'
    }

    stage('Execute Ansible Playbooks on Kubernetes Master') {
        ansiblePlaybook(
            playbook: "playbooks/k8deploy-main.yml",
            extras: "-u jits -i inventory/k8-inventory -e target_host=${comp} -e mvn=${mvn}"
        )
    }
}